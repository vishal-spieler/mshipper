@model SMEPanel.Models.Universal

@{
    ViewBag.Title = "MyProfile";
    Layout = "~/Views/Shared/Master.cshtml";
}

<h2>My Profile</h2>
<div class="page-content page-thin">
    <div class="row">

        <div class="col-md-8 col-sm-offset-2">
            <div class="panel panel-default no-bd">
                <div class="panel-header bg-dark">
                    <h2 class="panel-title"><strong>My Profile</strong> </h2>
                </div>
                <div class="panel-body bg-white">
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <form action="@Url.Action("MyProfile","DashBoard")" novalidate="novalidate" @*class="form-validation"*@ enctype="multipart/form-data" method="post">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <span class="input input--hoshi">
                                            @foreach(var itemnew in Model.objaddsmes)
                                            { 
                                            <input class="input__field input__field--hoshi" type="text" value="@itemnew.smename" id="name" name="name" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-4">
                                                <span class="input__label-content input__label-content--hoshi">Name</span>
                                            </label>
                                        </span>
                                       <div id="name-error" style="color:red;font-size: smaller"></div>
                                        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
                                        <script>

                                        $('#name').keyup(function () {
                                            var a = $("#name").val();

                                            if (a.match(/^[ t`~!@@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]+/gi)) {

                                                $("#name-error").html("space not allowed");

                                                $("#name").val(null);

                                                return false;
                                            }
                                            else {

                                                $("#name-error").html("");
                                                //document.form1.text1.focus();
                                                return true;
                                            }

                                        });
                                        </script>

                                    </div>
                                    <div class="col-sm-4">
                                        <script>

                                            $(document).ready(function () {
                                                $("#Email").keypress(function (e) {
                                                    if (e.which===32) {

                                                        return false;
                                                    }
                                                });
                                            });
                                        </script>
                                        <script type="text/javascript">

                                            function ValidateEmail(inputText) {
                                                var mailformat = /^\w+([\.-]?\w+)*@@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
                                                if (inputText.value.match(mailformat)) {
                                                    $("#Email-error").html("");
                                                    //document.form1.text1.focus();
                                                    return true;
                                                }
                                                else {
                                                    $("#Email-error").html("You have entered an invalid email address!");
                                                    //document.form1.text1.focus();
                                                    return false;
                                                }
                                            }
                                            $(document).ready(function () {

                                                $("#Email").blur(function () {
                                                    var a= $("#Email").val();
                                                    var mailformat = /^\w+([\.-]?\w+)*@@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
                                                    if (a.match(mailformat)) {
                                                        //document.form1.text1.focus();
                                                        return true;
                                                    }
                                                    else {
                                                        $("#Email").val(" ");
                                                        $("#Email-error").html("You have entered an invalid email address!");
                                                        //document.form1.text1.focus();
                                                        return false;
                                                    }
                                                });
                                            });


                                        //$("#Email").blur("click", function () {
                                        //    if (!ValidateEmail($("#Email").val())) {
                                        //        $("#Email-error").html("Invalid email address.");
                                        //    }
                                        //                 else {
                                        //        $("#Email-error").html("");
                                        //    }

                                        //});

                                        </script>
                                        <span class="input input--hoshi">
                                                @foreach (var itemnew in Model.objaddsmes)
                                                {
                                            <input class="input__field input__field--hoshi" type="email" id="Email" name="email" value="@itemnew.email" aria-required="true" onkeyup="ValidateEmail(this);" required />
                                                }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-2" for="input-5">
                                                <span class="input__label-content input__label-content--hoshi">Email</span>
                                            </label>
                                        </span>
                                        <div id="Email-error" style="color:red"></div>
                                    </div>
                                    <div class="col-sm-4">
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="shopname" readonly value="@itemnew.shopname" name="shopname" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-3" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Store Name</span>
                                            </label>
                                        </span>
                                        <div id="sname-error" style="color:red;font-size: smaller"></div>
                                        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
                                        <script>
                                            $(document).ready(function () {

                                                $('#shopname').keyup(function () {
                                                    var a = $("#shopname").val();
                                                    var mailformat = '^[ t]+';
                                                    if (a.match(mailformat)) {


                                                        $("#shopname-error").html("space not allowed");
                                                        $("#shopname").val(null);
                                                        //document.form1.text1.focus();
                                                        return false;
                                                    }
                                                    else {

                                                        $("#shopname-error").html("");
                                                        //document.form1.text1.focus();
                                                        return true;
                                                    }

                                                });
                                            });
                                        </script>
                                        <script>
                                        $(document).ready(function () {

                                            $("#shopname").blur(function () {
                                                var a = $("#shopname").val();
                                                var mailformat = /^[a-zA-Z ]*$/;
                                                if (a.match(mailformat)) {

                                                    //document.form1.text1.focus();
                                                    return true;
                                                }
                                                else {

                                                    $("#shopname").val(" ");
                                                    $("#sname-error").html("Special Char not allowed");
                                                    //$("#totalpackagecost-error").html("");
                                                    //document.form1.text1.focus();
                                                    return false;
                                                }
                                            });
                                        });
                                        </script>
                                    </div>
                                    <div class="col-sm-4">
                                        <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>
                                        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

                                        <script type="text/javascript">

                                           google.maps.event.addDomListener(window, 'load', function () {
                                               var places = new google.maps.places.Autocomplete(document.getElementById('location'));
                                               google.maps.event.addListener(places, 'place_changed', function () {
                                                   var place = places.getPlace();


                                               });
                                           });
                                        </script>
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="location" value="@itemnew.location" name="location" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Location</span>
                                            </label>
                                        </span>
                                        <div id="location-error" style="color:red; font-size:small"></div>
                                        <script>
                                            $(document).ready(function () {

                                                $('#location').keyup(function () {
                                                    var a = $("#location").val();
                                                    var mailformat = '^[ t]+';
                                                   
                                                    if (a.match(mailformat)) {


                                                        $("#location-error").html("space not allowed");
                                                        $("#location").val(null);
                                                        //document.form1.text1.focus();
                                                        return false;
                                                    }
                                                    else {

                                                        $("#location-error").html("");
                                                        //document.form1.text1.focus();
                                                        return true;
                                                    }

                                                });
                                            });
                                        </script>
                                       
                                    </div>
                                    <div class="col-sm-4">
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="address" name="address" value="@itemnew.address" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-2" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Address</span>
                                            </label>
                                        </span>
                                        <div id="address-error" style="color:red; font-size:small"></div>
                                        <script>


                                            $('#address').keyup(function () {
                                                var a = $("#address").val();
                                                var mailformat = '^[ t]+';
                                                if (a.match(mailformat)) {


                                                    $("#address-error").html("space not allowed");
                                                    $("#address").val(null);
                                                    //document.form1.text1.focus();
                                                    return false;
                                                }
                                                else {

                                                    $("#address-error").html("");
                                                    //document.form1.text1.focus();
                                                    return true;
                                                }

                                            });
                                        </script>
                                    </div>
                                    <div class="col-sm-4">
                                        <script>
                                            $(document).ready(function () {
                                                $("#mobile").keypress(function (e) {
                                                    if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                                                        $("#mobile-error").html("Digits Only").show().fadeOut("slow");
                                                        return false;
                                                    }
                                                });

                                               $("#mobile").blur(function () {
                                                   var phone = $("#mobile").val();
                                                   //alert($("#mobile").val());

                                                   if (mobile.value.length != 10) {
                                                       $("#mobile-error").html('Please enter valid mobile no');
                                                       $("#mobile").val(" ");
                                                       return false;
                                                   }
                                                   else {
                                                       $("#mobile-error").html("");
                                                   }

                                               });
                                           });
                                           function validatePhone(phoneText) {
                                               var filter = /[0-9]|\./;
                                               var space = /\s+/;
                                               if (filter.test(phoneText)) {
                                                   return true;
                                               }
                                               else {
                                                   return false;
                                               }
                                               if (space.test(phoneText)) {
                                                   return true;

                                               }
                                               else {
                                                   return false;
                                               }
                                           }
                                        </script>
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="mobile" value="@itemnew.mobileno" readonly="readonly" name="mobile"  onblur="validatePhone()" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-3" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Mobile</span>
                                            </label>
                                        </span>
                                        <div id="mobile-error" style="color:red"></div>
                                    </div>
                                    <div class="col-sm-4">
                                       
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="altmobile" readonly="readonly" name="altmobile" value="@itemnew.altmobileno" required onblur="validatealtPhone()" />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Alternate Mobile</span>

                                            </label>
                                        </span>
                                        <div id="altmobile-error" style="color:red"></div>
                                    </div>

                                    <script>
                                            $(document).ready(function () {
                                                $("#altmobile").keypress(function (e) {
                                                    if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                                                        $("#altmobile-error").html("Digits Only").show().fadeOut("slow");
                                                        return false;
                                                    }
                                                });
                                               $("#altmobile").blur(function () {
                                                   var phone = $("#altmobile").val();
                                                   //alert($("#altmobile").val());

                                                   if (altmobile.value.length != 10) {
                                                       $("#altmobile-error").html('Please enter valid mobile no');
                                                       $("#altmobile").val(" ");
                                                       return false;
                                                   }
                                                   else {
                                                       $("#altmobile-error").html("");
                                                   }

                                               });
                                           });
                                           function validatealtPhone(phone) {
                                               var filter = /^[0-9\b]+$/;
                                               var space = /\s+/;
                                               if (filter.test(phone)) {
                                                   return true;
                                               }
                                               else {
                                                   return false;
                                               }
                                               if (space.test(phone)) {
                                                   return true;

                                               }
                                               else {
                                                   return false;
                                               }
                                           }
                                    </script>

                                    <div class="col-sm-4">
                                        <div class="form-group">
                                            <label>Pin</label>
                                            <select class="form-control" name="pin" id="pin" data-search="true">
                                                @foreach (var itemnew in Model.objaddsmes)
                                                {
                                                    <option value="@itemnew.pincode" selected="selected">@itemnew.pincode</option>
                                                }
                                                @foreach (var itempincode in Model.objpincode)
                                                {
                                                    <option value="@itempincode.PinCode">@itempincode.PinCode</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                    <input type="hidden" name="hide" id="hide" />
                                    <input type="hidden" id="msg" name="msg" value="@ViewBag.msg" />
                                    <link href="~/assets/sweetalert.css" rel="stylesheet" />
                                    @*start for message display*@
                                    <script src="~/assets/sweetalert.min.js"></script>

                                    <script type="text/javascript">
                                        $(document).ready(function () {
                                            var msg=$("#msg").val();
                                            if (msg == "Your profile successfully updated") {

                                                swal({ title: 'Success', text: '"Your profile successfully updated"', type: 'success', showCancelButton: false, confirmButtonColor: '#b6ce38', confirmButtonText: 'Ok', closeOnConfirm: false });

                                            }
                                            
                                        });

                                    </script>
                                    @*end for message display*@

                                    @*jquery for get zone by pincode*@
                                    <script>
                                        $(document).ready(function () {

                                            $("#pin").change(function () {
                                                //var textvar = $("#" + $(this).attr("name") + " :selected").text();
                                                //document.getElementById("zone").value = $("#" + $(this).attr("name") + " :selected").val();
                                                //document.getElementById("hide").value = $("#" + $(this).attr("name") + " :selected").text();

                                                var pincode = $("#" + $(this).attr("name") + " :selected").val();
                                                var dist = "";
                                                $.ajax({
                                                    url: '/dashboard/GetDistrict',
                                                    data: { 'pin': pincode },
                                                    type: 'get',
                                                    cache: false,
                                                    success: function (data) {
                                                        msg = data;
                                                        $("#zone").val(msg);
                                                        //alert(data);
                                                    }
                                                });
                                            });
                                        });
                                    </script>
                                    <div class="col-sm-4">
                                        <span class="input input--hoshi">
                                            @foreach (var itemnew in Model.objaddsmes)
                                            {
                                            <input class="input__field input__field--hoshi" type="text" id="zone" value="@itemnew.Zone" name="zone" required />
                                            }
                                            <label class="input__label input__label--hoshi input__label--hoshi-color-3" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Zone</span>
                                            </label>
                                        </span>
                                    </div>
                                    <div class="col-sm-6">
                                        <span class="input input--hoshi">
                                                @foreach (var itemnew in Model.objaddsmes)
                                                {
                                                    <input type="hidden" id="prvimage" name="prvimage" value="@itemnew.profilepic" />
                                            <img id="myImg1" height="180" width="180" src="~/Images/@itemnew.profilepic" class="img-rounded img-thumbnail" alt="" required />
                                                }
                                            <input class="input__field input__field--hoshi" type="file" name="File" id="File" onchange="ValidateSingleInput(this), validate(this),readURL(this)" required />

                                            <label class="input__label input__label--hoshi input__label--hoshi-color-3" for="input-6">
                                                <span class="input__label-content input__label-content--hoshi">Upload Picture</span>
                                            </label>
                                        </span>
                                        <div id="viewimage"></div>

                                        <div id="viewimage1"></div>

                                    </div>

                                    <script type='text/javascript'>
                                       var _validFileExtensions = [".jpg", ".jpeg", ".bmp", ".gif", ".png"];
                                       function ValidateSingleInput(oInput) {
                                           if (oInput.type == "file") {
                                               var sFileName = oInput.value;
                                               if (sFileName.length > 0) {
                                                   var blnValid = false;
                                                   for (var j = 0; j < _validFileExtensions.length; j++) {
                                                       var sCurExtension = _validFileExtensions[j];
                                                       if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                                                           blnValid = true;
                                                           break;
                                                       }
                                                   }

                                                   if (!blnValid) {

                                                       //swal("Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", "));

                                                       document.getElementById('viewimage').innerHTML = "<font color='red'>Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", ");

                                                       oInput.value = "";
                                                       return false;
                                                   }
                                               }
                                           }
                                           return true;

                                       }
                                    </script>

                                    <script>


                                       function readURL(input) {
                                           if (input.files && input.files[0]) {

                                               var image_holder = $("#image-holder");
                                               image_holder.empty();


                                               var reader = new FileReader();

                                               reader.onload = function (e) {
                                                   $('#myImg1')
                                                   .attr('src', e.target.result)
                                       .width(150)
                                       .height(200);
                                               };

                                               image_holder.show();
                                               reader.readAsDataURL(input.files[0]);
                                           }
                                       }
                                    </script>
                                    <script>

                                       function validate() {
                                           $("#viewimage1").html("");
                                           $("#File").css("border-color", "#F0F0F0");
                                           var file_size = $("#File")[0].files[0].size;
                                           if (file_size > 2097152) {
                                               //alert("File size is greater than 2MB");
                                               $("#viewimage1").html("<font color=red>File size is greater than 2MB<font>");
                                               $("#File").css("border-color", "#FF0000");
                                               $("#File").val("");
                                               return false;
                                           }
                                           return true;
                                       }

                                       $('#File').click(function () {
                                           $("#viewimage1").html("");
                                           $("#viewimage").html("");
                                       });

                                    </script>
                                    
                                    @*<div class="col-sm-12">
                                        <div class="form-group">
                                            <label class="control-label">Are you OK with our terms?</label>
                                            <div class="option-group">
                                                <label for="terms" class="m-t-10">
                                                    <input type="checkbox" name="terms" id="terms" data-checkbox="icheckbox_square-blue" required />
                                                    I agree with terms and conditions
                                                </label>
                                            </div>
                                        </div>
                                    </div>*@
                                </div>
                                <div class="text-center  m-t-20">
                                    <input type="submit" class="btn btn-embossed btn-primary" name="myprofile" id="myprofile" value="Update" />
                                    <button type="reset" class="cancel btn btn-embossed btn-default m-b-10 m-r-0">Cancel</button>
                                    <div id="valid" style="color:red"></div>
                                </div>
                                <script>
                                    $(document).ready(function () {
                                        $("#myprofile").click(function () {
                                            if ($("#Email").val() == ""
                                            || $("#shopname").val() == "" || $("#location").val() == ""
                                               || $("#address").val() == "" || $("#mobile").val() == "" || $("#altmobile").val() == ""
                                               || $("#pin").val() == "" || $("#zone").val() == "" 
                                            ) {
                                                $("#valid").html("All fields are required");
                                                //$("#Email-error").html("This field is required");
                                                return false;
                                            }
                                                    
                                            else
                                            {
                                                $("#valid").html("");
                                            }
                                        });
                                    });
                                </script>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="row">

    </div>
    <div class="footer">
        <div class="copyright">
            <p class="pull-left sm-pull-reset">
                <span>Copyright <span class="copyright">©</span> 2015 </span>
                <span>mShipper</span>.
                <span>All rights reserved. </span>
            </p>
            <p class="pull-right sm-pull-reset">
                <span><a href="#" class="m-r-10">Support</a> | <a href="#" class="m-l-10 m-r-10">Terms of use</a> | <a href="#" class="m-l-10">Privacy Policy</a></span>
            </p>
        </div>
    </div>
</div>
